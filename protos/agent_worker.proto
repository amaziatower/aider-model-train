syntax = "proto3";

package agents;

message AgentId {
    string name = 1;
    string namespace = 2;
}

message RpcRequest {
    string request_id = 1;
    AgentId source = 2;
    AgentId target = 3;
    string method = 4;
    string data_type = 5;
    string data = 6;
    map<string, string> metadata = 7;
}

message RpcResponse {
    string request_id = 1;
    string result_type = 2;
    string result = 3;
    string error = 4;
    map<string, string> metadata = 5;
}

message Event {
    string namespace = 1;
    string topic_type = 2;
    string topic_source = 3;
    string data_type = 4;
    string data = 5;
    map<string, string> metadata = 6;
}

message RegisterAgentType {
    string type = 1;
}

message TypeSubscription {
    string topic_type = 1;
    string agent_type = 2;
}

message Subscription {
    oneof subscription {
        TypeSubscription typeSubscription = 1;
    }
}

message AddSubscription {
    Subscription subscription = 1;
}

service AgentRpc {
    rpc OpenChannel (stream Message) returns (stream Message);
}

message Message {
    oneof message {
        RpcRequest request = 1;
        RpcResponse response = 2;
        Event event = 3;
        RegisterAgentType registerAgentType = 4;
        AddSubscription addSubscription = 5;
    }
}

